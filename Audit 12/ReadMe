ğŸ” Audit Finding: A Typo leading to a locking of Funds
ğŸ¯ Project Name: Insure
ğŸ”¥ Severity: High
ğŸ›¡ï¸ Auditor: @Code4rena

Let's Start ğŸ‘‡ğŸ‘‡

ğŸ The Vulnerability:

ğŸ“Œ In Solidity, "==" checks if the value of two operands are equal or not. And "=" is used to set a certain value to variables.

ğŸ“Œ In PoolTemplate Contract, The unlock() function has a typo where it uses "==" rather than "=". So, instead of setting the insurances[_id].status to false, it compares it to false.

ğŸ“Œ Now, If a user calls unlock() multiple times, insurances[_id].amount will be subtracted multiple times. It will result in 'lockedAmount' being way smaller.


ğŸ’¡Recommended Mitigation Steps:
Change "insurances[_id].status == false;" to "insurances[_id].status = false;"


ğŸ“šReference:
https://lnkd.in/ddG3Vu4U
